{% extends 'mainapp/base.html' %}
{% load static %}
{% block title %}RewardPay{% endblock %}


{% block body %}
      <div class="main">
        <div class="container">
        <h1 class="logo cursive">
            RewardPay
        </h1>
        <div class="content">
            <h4 class="motto">Blockchin Powered Rental Rewards App.</h4>
            <h5 class="algo-status" style="color: #FFFFFF">{{ Network|cut:"\n"|cut:"{"|cut:"}" |safe }}</h5>
            <p><a href="/std-account/">Click here to see the current account list</a></p>
            <div class="subscribe">
                <h5 class="info-text">
                    Join the waiting list for the beta. We keep you posted.
                </h5>
                <div class="row">
                    <div class="col-md-4 col-md-offset-4 col-sm6-6 col-sm-offset-3 ">
                        <form class="form-inline" role="form">
                          <div class="form-group">
                            <label class="sr-only" for="exampleInputEmail2">Email address</label>
                            <input type="email" class="form-control transparent" placeholder="Your email here...">
                          </div>
                          <button type="submit" class="btn btn-danger btn-fill">Notify Me</button>
                        </form>

                    </div>
                </div>
            </div>
        </div>
        </div>

    <!-- ipfs file upload -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
    <script src="https://unpkg.com/ipfs-http-client@30.1.3/dist/index.js"></script>
    <script src="https://bundle.run/buffer@5.2.1"></script>
    <div class="container">
    <h3>Upload files to IPFS</h3>

    <input type="file" id="upload">

    <div id="link"></div>
    </div>
      </div>
    <script>
        const ipfs = window.IpfsHttpClient('ipfs.infura.io', '5001', { protocol: 'https' });

        $("#upload").on("change", function() {
            var reader = new FileReader();
            reader.onload = function (e) {

                const magic_array_buffer_converted_to_buffer = buffer.Buffer(reader.result);
                ipfs.add(magic_array_buffer_converted_to_buffer, (err, result) => {
                    console.log(err, result);

              let ipfsLink = "<a href='https://gateway.ipfs.io/ipfs/" + result[0].hash + "'>gateway.ipfs.io/ipfs/" + result[0].hash + "</a>";
              document.getElementById("link").innerHTML = ipfsLink;

                })
            }
            reader.readAsArrayBuffer(this.files[0]);
        })
    </script>


{% endblock %}